<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Eiken Grade 3 Passive Game</title>

<style>
body {
  font-family: "Hiragino Maru Gothic ProN", "Hiragino Maru Gothic", sans-serif;
  background: #f6f6f6;
  padding: 15px;
}

h1 {
  text-align: center;
  font-size: 20px;
  margin-bottom: 10px;
}

.question {
  background: #fff;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 6px;
  position: relative;
}

.question.wrong {
  background: #fff0f0;
  border: 2px solid #e74c3c;
}

.mark {
  position: absolute;
  top: 6px;
  right: 10px;
  font-size: 20px;
  color: #e74c3c;
  font-weight: bold;
}

.en {
  font-size: 16px;
}

.jp {
  font-size: 13px;
  color: #555;
  margin-bottom: 6px;
}

/* Â∑¶ÊèÉ„Åà„ÉªÁ∏¶‰∏ÄÂàó */
.options {
  margin-left: 10px;
}

.options label {
  display: block;
  font-size: 15px;
  margin: 4px 0;
}

button {
  font-size: 16px;
  padding: 8px 16px;
  margin: 6px 4px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

#checkBtn { background: #4CAF50; color: white; }
#shuffleBtn { background: #FF9800; color: white; }
#printBtn { background: #2196F3; color: white; }

canvas {
  position: fixed;
  top: 0;
  left: 0;
  pointer-events: none;
}

/* PDFÁî® */
@media print {
  body {
    background: white;
    padding: 8mm;
  }
  h1 { font-size: 16px; }
  .question { page-break-inside: avoid; }
  button, canvas { display: none; }
}
</style>
</head>

<body>

<h1>Ëã±Ê§ú3Á¥ö Âèó„ÅëË∫´„ÉªbeÂãïË©û„ÉªÂâçÁΩÆË©û</h1>

<div id="quiz"></div>

<button id="shuffleBtn">üîÄ ÂïèÈ°å„Ç∑„É£„ÉÉ„Éï„É´</button>
<button id="checkBtn">‰∏∏„Å§„Åë</button>
<button id="printBtn" onclick="window.print()">PDF„Å´„Åô„Çã</button>

<canvas id="confetti"></canvas>

<script>
const baseQuestions = [
  { en:"These cookies were („ÄÄ„ÄÄ„ÄÄ) by my grandmother.",
    jp:"„Åì„Çå„Çâ„ÅÆ„ÇØ„ÉÉ„Ç≠„Éº„ÅØÁ•ñÊØç„Å´„Çà„Å£„Å¶‰Ωú„Çâ„Çå„Åæ„Åó„Åü„ÄÇ",
    options:["made","make","making","makes"], answer:"made" },

  { en:"Rice is („ÄÄ„ÄÄ„ÄÄ) in many countries in Asia.",
    jp:"Á±≥„ÅØ„Ç¢„Ç∏„Ç¢„ÅÆÂ§ö„Åè„ÅÆÂõΩ„ÅßÈ£ü„Åπ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
    options:["eaten","eat","eating","eats"], answer:"eaten" },

  { en:"This song („ÄÄ„ÄÄ„ÄÄ) written by a famous singer.",
    jp:"„Åì„ÅÆÊ≠å„ÅØÊúâÂêç„Å™Ê≠åÊâã„Å´„Çà„Å£„Å¶Êõ∏„Åã„Çå„Åæ„Åó„Åü„ÄÇ",
    options:["was","is","were","are"], answer:"was" },

  { en:"English („ÄÄ„ÄÄ„ÄÄ) spoken all over the world.",
    jp:"Ëã±Ë™û„ÅØ‰∏ñÁïå‰∏≠„ÅßË©±„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
    options:["is","was","are","were"], answer:"is" },

  { en:"This library was cleaned („ÄÄ„ÄÄ„ÄÄ) the students.",
    jp:"„Åì„ÅÆÂõ≥Êõ∏È§®„ÅØÁîüÂæí„Åü„Å°„Å´„Çà„Å£„Å¶ÊéÉÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇ",
    options:["by","in","at","on"], answer:"by" },

  { en:"Many tall buildings are built („ÄÄ„ÄÄ„ÄÄ) this town.",
    jp:"„Åì„ÅÆÁî∫„Å´„ÅØÂ§ö„Åè„ÅÆÈ´ò„ÅÑÂª∫Áâ©„ÅåÂª∫„Å¶„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
    options:["in","by","on","at"], answer:"in" },

  { en:"The classroom was („ÄÄ„ÄÄ„ÄÄ) after school.",
    jp:"ÊïôÂÆ§„ÅØÊîæË™≤Âæå„Å´ÊéÉÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇ",
    options:["cleaned","clean","cleaning","cleans"], answer:"cleaned" },

  { en:"This picture („ÄÄ„ÄÄ„ÄÄ) drawn by my sister.",
    jp:"„Åì„ÅÆÁµµ„ÅØÁßÅ„ÅÆÂßâ„Å´„Çà„Å£„Å¶Êèè„Åã„Çå„Åæ„Åó„Åü„ÄÇ",
    options:["was","is","were","are"], answer:"was" },

  { en:"These chairs are („ÄÄ„ÄÄ„ÄÄ) in the music room.",
    jp:"„Åì„Çå„Çâ„ÅÆÊ§ÖÂ≠ê„ÅØÈü≥Ê•ΩÂÆ§„Åß‰Ωø„Çè„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
    options:["used","use","using","uses"], answer:"used" },

  { en:"This game is played („ÄÄ„ÄÄ„ÄÄ) many children.",
    jp:"„Åì„ÅÆ„Ç≤„Éº„É†„ÅØÂ§ö„Åè„ÅÆÂ≠ê„Å©„ÇÇ„Åü„Å°„Å´„Çà„Å£„Å¶ÈÅä„Å∞„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
    options:["by","in","at","on"], answer:"by" }
];

let questions = [];

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

function renderQuiz(){
  const quiz=document.getElementById("quiz");
  quiz.innerHTML="";
  questions.forEach((q,i)=>{
    shuffle(q.options);
    quiz.innerHTML+=`
      <div class="question" id="qbox${i}">
        <div class="en">${i+1}. ${q.en}</div>
        <div class="jp">${q.jp}</div>
        <div class="options">
          ${q.options.map(o =>
            `<label><input type="radio" name="q${i}" value="${o}"> ${o}</label>`
          ).join("")}
        </div>
      </div>`;
  });
}

function startGame(){
  questions=JSON.parse(JSON.stringify(baseQuestions));
  shuffle(questions);
  renderQuiz();
}

document.getElementById("shuffleBtn").onclick=startGame;

document.getElementById("checkBtn").onclick=()=>{
  let allCorrect=true;

  questions.forEach((q,i)=>{
    const box=document.getElementById(`qbox${i}`);
    box.classList.remove("wrong");
    const oldMark=box.querySelector(".mark");
    if(oldMark) oldMark.remove();

    const sel=document.querySelector(`input[name="q${i}"]:checked`);
    if(!sel || sel.value!==q.answer){
      allCorrect=false;
      box.classList.add("wrong");
      box.insertAdjacentHTML("beforeend", `<div class="mark">√ó</div>`);
    }
  });

  if(allCorrect){
    startConfetti();
    setTimeout(stopConfetti,5000);
    alert("üéâ ÂÖ®ÂïèÊ≠£Ëß£ÔºÅ");
  }else{
    alert("√ó„ÅÆÂïèÈ°å„Çí„ÇÇ„ÅÜ‰∏ÄÂ∫¶ËÄÉ„Åà„Å¶„Åø„Çà„ÅÜÔºÅ");
  }
};

/* Á¥ôÂêπÈõ™ */
let anim;
function startConfetti(){
  const c=document.getElementById("confetti");
  const ctx=c.getContext("2d");
  c.width=innerWidth; c.height=innerHeight;
  const p=[...Array(100)].map(()=>({
    x:Math.random()*c.width,
    y:Math.random()*c.height,
    r:Math.random()*4+3,
    c:`hsl(${Math.random()*360},100%,50%)`
  }));
  function draw(){
    ctx.clearRect(0,0,c.width,c.height);
    p.forEach(o=>{
      ctx.beginPath();
      ctx.fillStyle=o.c;
      ctx.arc(o.x,o.y,o.r,0,Math.PI*2);
      ctx.fill();
      o.y+=2; if(o.y>c.height)o.y=0;
    });
    anim=requestAnimationFrame(draw);
  }
  draw();
}
function stopConfetti(){
  cancelAnimationFrame(anim);
  const c = document.getElementById("confetti");
  const ctx = c.getContext("2d");
  ctx.clearRect(0, 0, c.width, c.height);
}

startGame();
</script>

</body>
</html>
