<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>G3 Passive Picture Grammar</title>

<style>
body {
  font-family: "Hiragino Maru Gothic ProN", sans-serif;
  background: #fdfefe;
  text-align: center;
}

/* ===== ç”»é¢ç”¨ ===== */
.card {
  max-width: 800px;
  margin: 20px auto;
  padding: 20px;
  border: 2px solid #ccc;
  border-radius: 16px;
}

img {
  max-width: 100%;
  border-radius: 12px;
}

.sentence {
  font-size: 26px;
  margin: 20px 0;
}

.choices button {
  font-size: 22px;
  padding: 10px 18px;
  margin: 6px;
}

.result {
  font-size: 24px;
  margin: 15px;
}

.correct { color: green; }
.wrong { color: red; }

.hidden { display: none; }

/* ç´™å¹é›ª */
.confetti {
  position: fixed;
  top: -10px;
  width: 8px;
  height: 14px;
  opacity: 0.8;
  animation: fall linear forwards;
}

@keyframes fall {
  to { transform: translateY(110vh) rotate(360deg); }
}

/* ===== PDFå°‚ç”¨ ===== */
#printArea {
  display: none;
}

@media print {
  body > *:not(#printArea) {
    display: none !important;
  }

  #printArea {
    display: block;
    width: 100%;
  }

  .print-row {
    display: flex;
    align-items: center;
    margin-bottom: 24px;
  }

  .print-row img {
    width: 40%;
    margin-right: 20px;
  }

  .print-text {
    width: 60%;
    font-size: 18px;
    text-align: left;
  }

  button {
    display: none;
  }
}
</style>
</head>

<body>

<h1>ğŸ“˜ Passive Picture Grammar</h1>

<div class="card">
  <img id="pic">
  <div class="sentence" id="sentence"></div>
  <div class="choices" id="choices"></div>
  <div class="result" id="result"></div>

  <button id="readBtn" class="hidden">ğŸ”Š Read</button>
  <button id="nextBtn" class="hidden">Next â–¶</button>
</div>

<button onclick="shuffleQuiz()">ğŸ”€ Shuffle & Try Again</button>
<button onclick="printPDF()">ğŸ–¨ PDFã§ä¿å­˜</button>

<!-- PDFå°‚ç”¨ã‚¨ãƒªã‚¢ -->
<div id="printArea"></div>

<script>
const quiz = [
  { img:"table_wood.png", text:"This table is made ( ___ ) wood.", answer:"of" },
  { img:"milk_cheese.png", text:"Cheese is made ( ___ ) milk.", answer:"from" },
  { img:"cookies_mother.png", text:"These cookies were made ( ___ ) my mother.", answer:"by" },
  { img:"rice_asia.png", text:"Rice is eaten ( ___ ) many Asian countries.", answer:"in" },
  { img:"spyfamily_world.png", text:"Spy x Family is known ( ___ ) many young people around the world.", answer:"to" },
  { img:"chopsticks_hashi.png", text:"Chopsticks are called hashi ( ___ ) Japanese, and bridges are also called hashi ( ___ ) Japanese.", answer:"in" },
  { img:"yard_snow.png", text:"The yard was covered ( ___ ) snow.", answer:"with" }
];

const choices = ["by","from","in","of","with","to"];
let index = 0;

const pic = document.getElementById("pic");
const sentence = document.getElementById("sentence");
const choicesDiv = document.getElementById("choices");
const result = document.getElementById("result");
const readBtn = document.getElementById("readBtn");
const nextBtn = document.getElementById("nextBtn");

function loadQuiz() {
  const q = quiz[index];
  pic.src = q.img;
  sentence.innerHTML = q.text;
  result.textContent = "";
  choicesDiv.innerHTML = "";
  readBtn.classList.add("hidden");
  nextBtn.classList.add("hidden");

  choices.forEach(w => {
    const b = document.createElement("button");
    b.textContent = w;
    b.onclick = () => selectWord(w);
    choicesDiv.appendChild(b);
  });
}

function selectWord(word) {
  const q = quiz[index];
  sentence.innerHTML = q.text.replace("( ___ )", `( ${word} )`);

  if (word === q.answer) {
    result.textContent = "Correct!";
    result.className = "result correct";
    readBtn.classList.remove("hidden");
    nextBtn.classList.remove("hidden");
  } else {
    result.textContent = "Try again!";
    result.className = "result wrong";
  }
}

readBtn.onclick = () => {
  const q = quiz[index];
  const u = new SpeechSynthesisUtterance(
    q.text.replace("( ___ )", q.answer)
  );
  u.lang = "en-US";
  u.rate = 0.7;
  speechSynthesis.speak(u);
};

nextBtn.onclick = () => {
  index++;
  if (index < quiz.length) {
    loadQuiz();
  } else {
    startConfetti();
  }
};

function shuffleQuiz() {
  quiz.sort(() => Math.random() - 0.5);
  index = 0;
  loadQuiz();
}

/* ç´™å¹é›ª */
function startConfetti() {
  const end = Date.now() + 3000;
  const colors = ["#ff6","#f66","#6cf","#9f9"];
  const timer = setInterval(() => {
    if (Date.now() > end) return clearInterval(timer);
    const c = document.createElement("div");
    c.className = "confetti";
    c.style.left = Math.random()*100+"vw";
    c.style.background = colors[Math.floor(Math.random()*colors.length)];
    c.style.animationDuration = (Math.random()*2+2)+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),3000);
  },100);
}

/* PDFç”Ÿæˆï¼ˆå°åˆ·ï¼‰ */
function printPDF() {
  const area = document.getElementById("printArea");
  area.innerHTML = "";

  quiz.forEach(q => {
    const text = q.text.replace("( ___ )", "(ã€€ã€€ã€€ã€€ã€€ã€€)");
    const row = document.createElement("div");
    row.className = "print-row";

    row.innerHTML = `
      <img src="${q.img}">
      <div class="print-text">
        <div>${text}</div>
        <div style="margin-top:8px;">
          by / from / in / of / with / to
        </div>
      </div>
    `;
    area.appendChild(row);
  });

  window.print();
}

loadQuiz();
</script>

</body>
</html>
